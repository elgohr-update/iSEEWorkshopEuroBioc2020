<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hands-on workshop recipes • iSEEWorkshopEuroBioc2020</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Hands-on workshop recipes">
<meta property="og:description" content="iSEEWorkshopEuroBioc2020">
<meta property="og:image" content="https://iSEE.github.io/iSEEWorkshopEuroBioc2020/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iSEEWorkshopEuroBioc2020</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Overview of the iSEE package</a>
    </li>
    <li>
      <a href="../articles/dataset.html">Preprocessing a data set for iSEE</a>
    </li>
    <li>
      <a href="../articles/recipes.html">Hands-on workshop recipes</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/iSEE/iSEEWorkshopEuroBioc2020/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="recipes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="recipes_files/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="recipes_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Hands-on workshop recipes</h1>
                        <h4 class="author">Kevin Rue-Albrecht, Charlotte Soneson, Federico Marini, and Aaron Lun</h4>
            
            <h4 class="date">December 16, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/iSEE/iSEEWorkshopEuroBioc2020/blob/master/vignettes/recipes.Rmd"><code>vignettes/recipes.Rmd</code></a></small>
      <div class="hidden name"><code>recipes.Rmd</code></div>

    </div>

    
    
<!-- Enable snowflakes in vignettes


<div class="snowflakes" aria-hidden="true">
  <div class="snowflake">
  ❅
  </div>
  <div class="snowflake">
  ❅
  </div>
  <div class="snowflake">
  ❆
  </div>
  <div class="snowflake">
  ❄
  </div>
  <div class="snowflake">
  ❅
  </div>
  <div class="snowflake">
  ❆
  </div>
  <div class="snowflake">
  ❄
  </div>
  <div class="snowflake">
  ❅
  </div>
  <div class="snowflake">
  ❆
  </div>
  <div class="snowflake">
  ❄
  </div>
</div>
-->
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette consists of a series of (independent) hands-on recipes, aimed at exploring the capabilities of <em><a href="https://bioconductor.org/packages/3.13/iSEE">iSEE</a></em> both interactively and programmatically. Each recipe consists of a short task and a screen shot of the desired appearance of the app instance that should be created. For each recipe, we provide a set of hints, as well as detailed instructions on how to solve the task both interactively (by clicking in the app) and programmatically (by directly setting up and launching the desired app instance).</p>
<p>For a general overview of the default <code>iSEE</code> panels, we refer to the <a href="overview.html">overview vignette</a>. For all the details about the panel classes and the associated slots, we refer to the help pages for the respective panel class (e.g., <code><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">?ReducedDimensionPlot</a></code>).</p>
</div>
<div id="prepare-the-session" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#prepare-the-session" class="anchor"></a>Prepare the session</h1>
<p>Before starting with the recipes, we need to load the required packages and the demo data set.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iSEE/iSEE">iSEE</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/iSEE/iSEEu">iSEEu</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://iSEE.github.io/iSEEWorkshopEuroBioc2020">iSEEWorkshopEuroBioc2020</a></span><span class="op">)</span>
<span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_demo_sce.html">load_demo_sce</a></span><span class="op">(</span><span class="st">"pbmc3k"</span><span class="op">)</span>
<span class="va">sce</span>
<span class="co">#&gt; class: SingleCellExperiment </span>
<span class="co">#&gt; dim: 32738 2643 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(2): counts logcounts</span>
<span class="co">#&gt; rownames(32738): MIR1302-10 FAM138A ... AC002321.2 AC002321.1</span>
<span class="co">#&gt; rowData names(21): ENSEMBL_ID Symbol_TENx ... FDR_cluster13</span>
<span class="co">#&gt;   FDR_cluster14</span>
<span class="co">#&gt; colnames(2643): Cell1 Cell2 ... Cell2699 Cell2700</span>
<span class="co">#&gt; colData names(23): Sample Barcode ... labels_fine labels_ont</span>
<span class="co">#&gt; reducedDimNames(3): PCA TSNE UMAP</span>
<span class="co">#&gt; altExpNames(0):</span></code></pre></div>
</div>
<div id="recipe-1-panel-organisation" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-1-panel-organisation" class="anchor"></a>Recipe 1: Panel organisation</h1>
<p>Using the <code>pbmc3k</code> data set, create an app that contains only a reduced dimension plot panel, a row data plot panel and a column data plot panel. The widths of the three panels should be 3, 4 and 5 units, respectively.</p>
<details><summary>Hints</summary><ul>
<li>
Panels can be added, removed and resized via the <code>Organization</code> button in the top right corner of the app.
</li>
<li>
To pre-specify the panels to be included in the app, use the <code>initial</code> argument to <code><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE()</a></code>.
</li>
<li>
You can remind yourself of the list of slot names available for each panel class and their respective value using the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function on any instance of a panel object, e.g. <code><a href="https://rdrr.io/r/utils/str.html">str(ReducedDimensionPlot())</a></code>.
</li>
<li>
For more information about the different types of panels, see the <a href="overview.html">overview vignette</a> or the help pages for the respective panel classes.
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with the default set of panels.
</li>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
Click on the <code>Organization</code> button in the top right corner of the app, and then click on <code>Organize panels</code>.
</li>
<li>
In the pop-up window that appears, click on the little <code>x</code> next to all the panels that you want to remove (all but the <code>Reduced dimension plot 1</code>, <code>Column data plot 1</code> and <code>Row data plot 1</code>).
</li>
<li>
Drag and drop the remaining three panel names in the correct order.
</li>
<li>
For each panel, set the correct panel width by modifying the value in the <code>Width</code> dropdown menu.
</li>
<li>
Click <code>Apply settings</code>.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/RowDataPlot-class.html">RowDataPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html">ColumnDataPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_01.png" width="992"></p>
</div>
<div id="recipe-2-data-parameters-configuration---selecting-columns-to-display" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-2-data-parameters-configuration---selecting-columns-to-display" class="anchor"></a>Recipe 2: Data parameters configuration - selecting columns to display</h1>
<p>Using the <code>pbmc3k</code> data set, visualize the cell type assignment against the cluster membership, with the aim to identify the predominant cell type in each cluster. In this case, since both cell annotations are categorical, <code>iSEE</code> will generate a so called Hinton plot.</p>
<details><summary>Hints</summary><ul>
<li>
Column (in this case cell) annotations can be visualized using a <code>ColumnDataPlot</code> panel.
</li>
<li>
The cluster labels are available in the <code>Cluster</code> column of <code>colData(sce)</code>.
</li>
<li>
The cell type assignments are available in the <code>labels_fine</code> column of <code>colData(sce)</code> (more coarse-grained assignments are provided in the <code>labels_main</code> column).
</li>
<li>
<code>iSEE</code> will automatically determine the plot type depending on the type of selected variables.
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with a single <code>ColumnDataPlot</code> panel spanning the full application window)
</li>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html">ColumnDataPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">12L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
In the <code>ColumnDataPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box.
</li>
<li>
Under <code>Column of interest (Y-axis)</code>, select the label column (e.g., <code>labels_fine</code>).
</li>
<li>
Under <code>X-axis</code>, select <code>Column data</code>, and under <code>Column of interest (X-axis)</code>, select <code>Cluster</code>.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html">ColumnDataPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">12L</span>, XAxis <span class="op">=</span> <span class="st">"Column data"</span>,
                   YAxis <span class="op">=</span> <span class="st">"labels_fine"</span>, XAxisColumnData <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_02.png" width="992"></p>
</div>
<div id="recipe-3-data-parameters-configuration---displaying-multiple-reduced-dimension-representations" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-3-data-parameters-configuration---displaying-multiple-reduced-dimension-representations" class="anchor"></a>Recipe 3: Data parameters configuration - displaying multiple reduced dimension representations</h1>
<p>Using the <code>pbmc3k</code> data set, display both the tSNE and UMAP representations next to each other.</p>
<details><summary>Hints</summary><ul>
<li>
Reduced dimension representations can be displayed using <code>ReducedDimensionPlot</code> panels.
</li>
<li>
The reduced dimension representations in the SingleCellExperiment object can be accessed by name (<code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDimNames(sce)</a></code> lists the available representations).
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with two <code>ReducedDimensionPlot</code> panels, each spanning half the application window)
</li>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
In the first <code>ReducedDimensionPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box.
</li>
<li>
In the <code>Type</code> selection box, choose <code>TSNE</code>.
</li>
<li>
In the second <code>ReducedDimensionPlot</code> panel, repeat the procedure but instead select <code>UMAP</code>.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"UMAP"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_03.png" width="992"></p>
</div>
<div id="recipe-4-data-parameters-configuration---displaying-the-expression-of-a-specific-gene-across-clusters" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-4-data-parameters-configuration---displaying-the-expression-of-a-specific-gene-across-clusters" class="anchor"></a>Recipe 4: Data parameters configuration - displaying the expression of a specific gene across clusters</h1>
<p>Using the <code>pbmc3k</code> data set, plot the distribution of the logcount values for the gene <code>CD74</code> in each of the clusters.</p>
<details><summary>Hints</summary><ul>
<li>
Gene expression values can be displayed using a <code>FeatureAssayPlot</code> panel.
</li>
<li>
To select a gene, specify the ID provided as row names in the SingleCellExperiment.
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with a <code>FeatureAssayPlot</code> panel, spanning the full application window)
</li>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">12L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
In the <code>FeatureAssayPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box.
</li>
<li>
Under <code>Y-axis feature</code>, type or select <code>CD74</code>.
</li>
<li>
Under <code>X-axis</code>, select <code>Column data</code>, and under <code>Column of interest (X-axis)</code>, select <code>Cluster</code>.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">12L</span>, XAxis <span class="op">=</span> <span class="st">"Column data"</span>,
                     YAxisFeatureName <span class="op">=</span> <span class="st">"CD74"</span>, XAxisColumnData <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_04.png" width="992"></p>
</div>
<div id="recipe-5-visual-parameters-configuration---coloring-reduced-dimension-representations-by-cell-annotation" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-5-visual-parameters-configuration---coloring-reduced-dimension-representations-by-cell-annotation" class="anchor"></a>Recipe 5: Visual parameters configuration - coloring reduced dimension representations by cell annotation</h1>
<p>Using the <code>pbmc3k</code> data set, display two tSNE representations next to each other. In the first one, color the cells by the cluster label. In the second one, color the cells by the log10 of the total UMI count (<code>log10_total</code> column of <code>colData(sce)</code>).</p>
<details><summary>Hints</summary><ul>
<li>
Reduced dimension representations can be displayed using <code>ReducedDimensionPlot</code> panels.
</li>
<li>
The reduced dimension representations in the SingleCellExperiment object can be accessed by name (<code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDimNames(sce)</a></code> lists the available representations).
</li>
<li>
The cluster labels are available in the <code>Cluster</code> column of <code>colData(sce)</code>.
</li>
<li>
Point attributes can be accessed in the <code>Visual parameters</code> collapsible box. To display or hide the possible options, check the corresponding checkboxes (<code>Color</code>, <code>Shape</code>, <code>Size</code>, <code>Point</code>).
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with two <code>ReducedDimensionPlot</code> panels, each spanning half the application window)
</li>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
In each <code>ReducedDimensionPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box and under <code>Type</code>, choose <code>TSNE</code>.
</li>
<li>
In the first <code>ReducedDimensionPlot</code> panel, click to expand the <code>Visual parameters</code> collapsible box.
</li>
<li>
Make sure that the <code>Color</code> checkbox is ticked.
</li>
<li>
Under <code>Color by</code>, select <code>Column data</code>.
</li>
<li>
In the dropdown menu that appears, select <code>Cluster</code>.
</li>
<li>
In the second <code>ReducedDimensionPlot</code> panel, repeat the procedure but instead select <code>log10_total</code>.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         ColorBy <span class="op">=</span> <span class="st">"Column data"</span>,
                         ColorByColumnData <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         ColorBy <span class="op">=</span> <span class="st">"Column data"</span>,
                         ColorByColumnData <span class="op">=</span> <span class="st">"log10_total"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_05.png" width="992"></p>
</div>
<div id="recipe-6-visual-parameters-configuration---coloring-reduced-dimension-representations-by-gene-expression" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-6-visual-parameters-configuration---coloring-reduced-dimension-representations-by-gene-expression" class="anchor"></a>Recipe 6: Visual parameters configuration - coloring reduced dimension representations by gene expression</h1>
<p>Using the <code>pbmc3k</code> data set, display two tSNE representations next to each other. In the first one, color the cells by the logcounts expression level of <code>CD3D</code>. In the second one, color the cells by the logcounts expression level of <code>CD79B</code>.</p>
<details><summary>Hints</summary><ul>
<li>
Reduced dimension representations can be displayed using <code>ReducedDimensionPlot</code> panels.
</li>
<li>
The reduced dimension representations in the SingleCellExperiment object can be accessed by name (<code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDimNames(sce)</a></code> lists the available representations).
</li>
<li>
To select a gene, specify the ID provided as row names in the SingleCellExperiment.
</li>
<li>
Point attributes can be accessed in the <code>Visual parameters</code> collapsible box. To display or hide the possible options, check the corresponding checkboxes (<code>Color</code>, <code>Shape</code>, <code>Size</code>, <code>Point</code>).
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with two <code>ReducedDimensionPlot</code> panels, each spanning half the application window)
</li>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
In each <code>ReducedDimensionPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box and under <code>Type</code>, choose <code>TSNE</code>.
</li>
<li>
In the first <code>ReducedDimensionPlot</code> panel, click to expand the <code>Visual parameters</code> collapsible box.
</li>
<li>
Make sure that the <code>Color</code> checkbox is ticked.
</li>
<li>
Under <code>Color by</code>, select <code>Feature name</code>.
</li>
<li>
In the dropdown menu that appears, select or type <code>CD3D</code>.
</li>
<li>
In the second <code>ReducedDimensionPlot</code> panel, repeat the procedure but instead select <code>CD79B</code>.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         ColorBy <span class="op">=</span> <span class="st">"Feature name"</span>,
                         ColorByFeatureName <span class="op">=</span> <span class="st">"CD3D"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         ColorBy <span class="op">=</span> <span class="st">"Feature name"</span>,
                         ColorByFeatureName <span class="op">=</span> <span class="st">"CD79B"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_06.png" width="992"></p>
</div>
<div id="recipe-7-visual-parameters-configuration---changing-the-size-and-opacity-of-points" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-7-visual-parameters-configuration---changing-the-size-and-opacity-of-points" class="anchor"></a>Recipe 7: Visual parameters configuration - changing the size and opacity of points</h1>
<p>Using the <code>pbmc3k</code> data set, display two tSNE representations next to each other. In the first one, set the point size to 0.5. In the second one, set the point size to 3 and the opacity to 0.2.</p>
<details><summary>Hints</summary><ul>
<li>
Reduced dimension representations can be displayed using <code>ReducedDimensionPlot</code> panels.
</li>
<li>
The reduced dimension representations in the SingleCellExperiment object can be accessed by name (<code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDimNames(sce)</a></code> lists the available representations).
</li>
<li>
Point attributes can be accessed in the <code>Visual parameters</code> collapsible box. To display or hide the possible options, check the corresponding checkboxes (<code>Color</code>, <code>Shape</code>, <code>Size</code>, <code>Point</code>).
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with two <code>ReducedDimensionPlot</code> panels, each spanning half the application window)
</li>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
In each <code>ReducedDimensionPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box and under <code>Type</code>, choose <code>TSNE</code>.
</li>
<li>
In the first <code>ReducedDimensionPlot</code> panel, click to expand the <code>Visual parameters</code> collapsible box.
</li>
<li>
Make sure that the <code>Size</code> checkbox is ticked.
</li>
<li>
Under <code>Size by</code>, select <code>None</code>.
</li>
<li>
In the text box underneath, type 0.5.
</li>
<li>
In the second <code>ReducedDimensionPlot</code> panel, click to expand the <code>Visual parameters</code> collapsible box.
</li>
<li>
Make sure that the <code>Size</code> and <code>Point</code> checkboxes are ticked.
</li>
<li>
Under <code>Size by</code>, select <code>None</code>.
</li>
<li>
In the text box underneath, type 3.
</li>
<li>
Under <code>Point opacity</code>, drag the slider to 0.2.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         PointSize <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         PointSize <span class="op">=</span> <span class="fl">3</span>, PointAlpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_07.png" width="992"></p>
</div>
<div id="recipe-8-selection-configuration" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-8-selection-configuration" class="anchor"></a>Recipe 8: Selection configuration</h1>
<p>Using the <code>pbmc3k</code> data set, display the expression (logcounts) of <code>CD3D</code> across the assigned clusters, as well as a tSNE representation colored by the cluster label. Select all cells with a logcount expression value of <code>CD3D</code> between (approximately) 0.5 and 4, and highlight these in the tSNE plot by means of transparency.</p>
<details><summary>Hints</summary><ul>
<li>
Reduced dimension representations can be displayed using <code>ReducedDimensionPlot</code> panels.
</li>
<li>
The reduced dimension representations in the SingleCellExperiment object can be accessed by name (<code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDimNames(sce)</a></code> lists the available representations).
</li>
<li>
Gene expression values can be displayed using a <code>FeatureAssayPlot</code> panel.
</li>
<li>
To select a gene, specify the ID provided as row names in the SingleCellExperiment.
</li>
<li>
Transmission of selections is set up in the <code>Selection parameters</code> collapsible box.
</li>
<li>
Points can be selected by clicking and dragging the mouse to draw a rectangle around them, or by repeatedly clicking to make a lasso (free-form) selection.
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with one <code>FeatureAssayPlot</code> panel and one <code>ReducedDimensionPlot</code> panel, each spanning half the application window)
</li>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
In the <code>FeatureAssayPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box and under <code>Y-axis feature</code>, type or select <code>CD3D</code>.
</li>
<li>
Under <code>X-axis</code>, select <code>Column data</code>, and under <code>X-axis column data</code>, select <code>Cluster</code>.
</li>
<li>
In the <code>FeatureAssayPlot</code> panel, use the mouse to drag a rectangle around all points with a logcount expression value (y-axis) between approximately 0.5 and 4.
</li>
<li>
In the <code>ReducedDimensionPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box and under <code>Type</code>, choose <code>TSNE</code>.
</li>
<li>
In the <code>ReducedDimensionPlot</code> panel, further click to expand the <code>Visual parameters</code> collapsible box, make sure that the <code>Color</code> checkbox is ticked. Under <code>Color by</code>, select <code>Column data</code>. In the dropdown menu that appears, type or select <code>Cluster</code>.
</li>
<li>
In the <code>ReducedDimensionPlot</code> panel, click to expand the <code>Selection parameters</code> collapsible box.
</li>
<li>
Under <code>Receive column selection from</code>, select <code>Feature assay plot 1</code>.
</li>
<li>
Under <code>Selection effect</code>, make sure that <code>Transparent</code> is chosen.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, 
                     BrushData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">15</span>, 
                                      ymin <span class="op">=</span> <span class="fl">0.5</span>, ymax <span class="op">=</span> <span class="fl">4</span>, 
                       mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X"</span>, y <span class="op">=</span> <span class="st">"Y"</span>, group <span class="op">=</span> <span class="st">"GroupBy"</span><span class="op">)</span>, 
                       direction <span class="op">=</span> <span class="st">"xy"</span>, 
                       brushId <span class="op">=</span> <span class="st">"FeatureAssayPlot1_Brush"</span>, 
                       outputId <span class="op">=</span> <span class="st">"FeatureAssayPlot1"</span><span class="op">)</span>,
                     XAxis <span class="op">=</span> <span class="st">"Column data"</span>, 
                     XAxisColumnData <span class="op">=</span> <span class="st">"Cluster"</span>, YAxisFeatureName <span class="op">=</span> <span class="st">"CD3D"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         ColorBy <span class="op">=</span> <span class="st">"Column data"</span>,
                         ColorByColumnData <span class="op">=</span> <span class="st">"Cluster"</span>,
                         SelectionEffect <span class="op">=</span> <span class="st">"Transparent"</span>, 
                         ColumnSelectionSource <span class="op">=</span> <span class="st">"FeatureAssayPlot1"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_08.png" width="992"></p>
</div>
<div id="recipe-9-verifying-the-cell-type-identity-of-clusters" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-9-verifying-the-cell-type-identity-of-clusters" class="anchor"></a>Recipe 9: Verifying the cell type identity of clusters</h1>
<p>Using the <code>pbmc3k</code> data set, create a scatter plots displaying the (logcounts) expression values of <code>CD79A</code> vs <code>CD74</code>, as well as a Hinton plot of the cluster and cell type assignment annotations. Select the cells co-expressing <code>CD79A</code> and <code>CD74</code> in the scatter plot. Which cell type/cluster(s) do these correspond to (color these points in the Hinton plot)?</p>
<details><summary>Hints</summary><ul>
<li>
Gene expression values can be displayed using a <code>FeatureAssayPlot</code> panel.
</li>
<li>
To select a gene, specify the ID provided as row names in the SingleCellExperiment.
</li>
<li>
Column (in this case cell) annotations can be visualized using a <code>ColumnDataPlot</code> panel.
</li>
<li>
The cluster labels are available in the <code>Cluster</code> column of <code>colData(sce)</code>. Coarse-grained cell type labels are available in the <code>labels_main</code> column.
</li>
<li>
Transmission of selections is set up in the <code>Selection parameters</code> collapsible box.
</li>
<li>
Points can be selected by clicking and dragging the mouse to draw a rectangle around them, or by repeatedly clicking to make a lasso (free-form) selection.
</li>
</ul></details><details><summary>Solution (interactively)</summary><ul>
<li>
First open an application with one <code>FeatureAssayPlot</code> panel and one <code>ColumnDataPlot</code> panel, each spanning half of the application window)
</li>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span>,
                                <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html">ColumnDataPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/runApp.html">runApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></code></pre></div>
<li>
In the <code>FeatureAssayPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box.
</li>
<li>
Under <code>Y-axis feature</code>, type or select <code>CD79A</code>.
</li>
<li>
Under <code>X-axis</code>, select <code>Feature name</code>, and under <code>X-axis feature</code>, type or select <code>CD74</code>.
</li>
<li>
In the <code>ColumnDataPlot</code> panel, click to expand the <code>Data parameters</code> collapsible box.
</li>
<li>
Under <code>Column of interest (Y-axis)</code>, type or select <code>labels_main</code>.
</li>
<li>
Under <code>X-axis</code>, select <code>Column data</code>, and under <code>Column of interest (X-axis)</code>, select <code>Cluster</code>.
</li>
<li>
In the <code>FeatureAssayPlot</code> panel, use the mouse to drag a rectangle around all points co-expressing <code>CD79A</code> and <code>CD74</code>.
</li>
<li>
In the <code>ColumnDataPlot</code> panel, click to expand the <code>Selection parameters</code> collapsible box.
</li>
<li>
Under <code>Receive column selection from</code>, select <code>Feature assay plot 1</code>.
</li>
<li>
Under <code>Selection effect</code>, make sure that <code>Color</code> is chosen.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/FeatureAssayPlot-class.html">FeatureAssayPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, XAxis <span class="op">=</span> <span class="st">"Feature name"</span>,
                     YAxisFeatureName <span class="op">=</span> <span class="st">"CD79A"</span>, 
                     XAxisFeatureName <span class="op">=</span> <span class="st">"CD74"</span>,
                     BrushData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                       xmin <span class="op">=</span> <span class="fl">0.3</span>, xmax <span class="op">=</span> <span class="fl">7</span>, 
                       ymin <span class="op">=</span> <span class="fl">0.3</span>, ymax <span class="op">=</span> <span class="fl">7</span>, 
                       mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X"</span>, y <span class="op">=</span> <span class="st">"Y"</span>, colour <span class="op">=</span> <span class="st">"ColorBy"</span><span class="op">)</span>, 
                       direction <span class="op">=</span> <span class="st">"xy"</span>, brushId <span class="op">=</span> <span class="st">"FeatureAssayPlot1_Brush"</span>, 
                       outputId <span class="op">=</span> <span class="st">"FeatureAssayPlot1"</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html">ColumnDataPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, XAxis <span class="op">=</span> <span class="st">"Column data"</span>, 
                   YAxis <span class="op">=</span> <span class="st">"labels_main"</span>, 
                   XAxisColumnData <span class="op">=</span> <span class="st">"Cluster"</span>,
                   ColumnSelectionSource <span class="op">=</span> <span class="st">"FeatureAssayPlot1"</span>,
                   SelectionEffect <span class="op">=</span> <span class="st">"Color"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_09.png" width="992"></p>
</div>
<div id="recipe-10-using-modes-from-iseeu" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-10-using-modes-from-iseeu" class="anchor"></a>Recipe 10: Using modes from <code>iSEEu</code>
</h1>
<p>Using the <code>pbmc3k</code> data set, load <code>iSEEu</code> and use the <code>modeReducedDim</code> mode to open an app displaying all the reduced dimension representations stored in the SingleCellExperiment object. Color the representations by the cell type assignment.</p>
<details><summary>Hints</summary><ul>
<li>
The cell type assignments are available in the <code>labels_fine</code> column of <code>colData(sce)</code> (more coarse-grained assignments are provided in the <code>labels_main</code> column).
</li>
<li>
The annotation to color by can be specified when calling <code><a href="https://rdrr.io/pkg/iSEEu/man/modeReducedDim.html">iSEEu::modeReducedDim()</a></code>.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEEu/man/modeReducedDim.html">modeReducedDim</a></span><span class="op">(</span><span class="va">sce</span>, colorBy <span class="op">=</span> <span class="st">"labels_main"</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_10.png" width="992"></p>
</div>
<div id="recipe-11---including-a-tour" class="section level1">
<h1 class="hasAnchor">
<a href="#recipe-11---including-a-tour" class="anchor"></a>Recipe 11 - Including a tour</h1>
<p>Using the <code>pbmc3k</code> data set, display two tSNE representations next to each other. In the first one, color the cells by the logcounts expression level of <code>CD3D</code>. In the second one, color the cells by the logcounts expression level of <code>CD79B</code>. Also include a small tour that starts with a welcome message, next walks through the two panels, giving an informative message for each, and finally ends with a concluding message to the user.</p>
<details><summary>Hints</summary><ul>
<li>
Reduced dimension representations can be displayed using <code>ReducedDimensionPlot</code> panels.
</li>
<li>
The reduced dimension representations in the SingleCellExperiment object can be accessed by name (<code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDimNames(sce)</a></code> lists the available representations).
</li>
<li>
To select a gene, specify the ID provided as row names in the SingleCellExperiment.
</li>
<li>
Point attributes can be accessed in the <code>Visual parameters</code> collapsible box. To display or hide the possible options, check the corresponding checkboxes (<code>Color</code>, <code>Shape</code>, <code>Size</code>, <code>Point</code>).
</li>
<li>
Tours are provided via the <code>tour</code> argument to <code><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE()</a></code>.
</li>
<li>
A tour is defined by a two-column data frame, with columns named <code>element</code> and <code>intro</code>. The <code>element</code> column contains the names of UI elements, prefixed by a hash sign. More details, including how to find the name of a particular UI elements, can be found in the <code>Configuring iSEE apps</code> vignette of <code>iSEE</code>.
</li>
</ul></details><details><p><summary>Solution (programmatically)</summary></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    element <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">"#Welcome"</span>,
        <span class="st">"#ReducedDimensionPlot1"</span>,
        <span class="st">"#ReducedDimensionPlot2"</span>,
        <span class="st">"#Conclusion"</span><span class="op">)</span>,
    intro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">"Welcome to this tour!"</span>,
        <span class="st">"This is the first reduced dimension plot"</span>,
        <span class="st">"And here is the second one"</span>,
        <span class="st">"Thank you for taking this tour!"</span><span class="op">)</span>,
    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/iSEE.html">iSEE</a></span><span class="op">(</span><span class="va">sce</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         ColorBy <span class="op">=</span> <span class="st">"Feature name"</span>,
                         ColorByFeatureName <span class="op">=</span> <span class="st">"CD3D"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ReducedDimensionPlot-class.html">ReducedDimensionPlot</a></span><span class="op">(</span>PanelWidth <span class="op">=</span> <span class="fl">6L</span>, Type <span class="op">=</span> <span class="st">"TSNE"</span>,
                         ColorBy <span class="op">=</span> <span class="st">"Feature name"</span>,
                         ColorByFeatureName <span class="op">=</span> <span class="st">"CD79B"</span><span class="op">)</span><span class="op">)</span>, 
    tour <span class="op">=</span> <span class="va">tour</span><span class="op">)</span></code></pre></div>
</details><p><img src="screenshots/recipe_11.png" width="992"></p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R Under development (unstable) (2020-11-26 r79513)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 20.04.1 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] parallel  stats4    stats     graphics  grDevices utils     datasets </span>
<span class="co">#&gt; [8] methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] iSEEWorkshopEuroBioc2020_0.0.1 iSEEu_1.3.0                   </span>
<span class="co">#&gt;  [3] iSEE_2.3.3                     SingleCellExperiment_1.13.3   </span>
<span class="co">#&gt;  [5] SummarizedExperiment_1.21.1    Biobase_2.51.0                </span>
<span class="co">#&gt;  [7] GenomicRanges_1.43.1           GenomeInfoDb_1.27.3           </span>
<span class="co">#&gt;  [9] IRanges_2.25.5                 S4Vectors_0.29.6              </span>
<span class="co">#&gt; [11] BiocGenerics_0.37.0            MatrixGenerics_1.3.0          </span>
<span class="co">#&gt; [13] matrixStats_0.57.0             BiocStyle_2.19.1              </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] nlme_3.1-150           bitops_1.0-6           fs_1.5.0              </span>
<span class="co">#&gt;  [4] RColorBrewer_1.1-2     rprojroot_2.0.2        tools_4.1.0           </span>
<span class="co">#&gt;  [7] R6_2.5.0               DT_0.16                vipor_0.4.5           </span>
<span class="co">#&gt; [10] mgcv_1.8-33            colorspace_2.0-0       GetoptLong_1.0.5      </span>
<span class="co">#&gt; [13] tidyselect_1.1.0       compiler_4.1.0         textshaping_0.2.1     </span>
<span class="co">#&gt; [16] Cairo_1.5-12.2         shinyjs_2.0.0          desc_1.2.0            </span>
<span class="co">#&gt; [19] DelayedArray_0.17.5    colourpicker_1.1.0     scales_1.1.1          </span>
<span class="co">#&gt; [22] pkgdown_1.6.1          systemfonts_0.3.2      stringr_1.4.0         </span>
<span class="co">#&gt; [25] digest_0.6.27          rmarkdown_2.6          XVector_0.31.1        </span>
<span class="co">#&gt; [28] pkgconfig_2.0.3        htmltools_0.5.0        fastmap_1.0.1         </span>
<span class="co">#&gt; [31] htmlwidgets_1.5.3      rlang_0.4.9            GlobalOptions_0.1.2   </span>
<span class="co">#&gt; [34] shiny_1.5.0            shape_1.4.5            generics_0.1.0        </span>
<span class="co">#&gt; [37] jsonlite_1.7.2         dplyr_1.0.2            RCurl_1.98-1.2        </span>
<span class="co">#&gt; [40] magrittr_2.0.1         GenomeInfoDbData_1.2.4 Matrix_1.2-18         </span>
<span class="co">#&gt; [43] Rcpp_1.0.5             munsell_0.5.0          lifecycle_0.2.0       </span>
<span class="co">#&gt; [46] stringi_1.5.3          yaml_2.2.1             rintrojs_0.2.2        </span>
<span class="co">#&gt; [49] zlibbioc_1.37.0        grid_4.1.0             promises_1.1.1        </span>
<span class="co">#&gt; [52] ggrepel_0.8.2          shinydashboard_0.7.1   crayon_1.3.4          </span>
<span class="co">#&gt; [55] miniUI_0.1.1.1         lattice_0.20-41        splines_4.1.0         </span>
<span class="co">#&gt; [58] circlize_0.4.11        knitr_1.30             ComplexHeatmap_2.7.1  </span>
<span class="co">#&gt; [61] pillar_1.4.7           igraph_1.2.6           rjson_0.2.20          </span>
<span class="co">#&gt; [64] glue_1.4.2             evaluate_0.14          BiocManager_1.30.10   </span>
<span class="co">#&gt; [67] png_0.1-7              vctrs_0.3.5            httpuv_1.5.4          </span>
<span class="co">#&gt; [70] gtable_0.3.0           purrr_0.3.4            clue_0.3-58           </span>
<span class="co">#&gt; [73] assertthat_0.2.1       ggplot2_3.3.2          xfun_0.19             </span>
<span class="co">#&gt; [76] mime_0.9               xtable_1.8-4           later_1.1.0.1         </span>
<span class="co">#&gt; [79] viridisLite_0.3.0      ragg_0.4.0             tibble_3.0.4          </span>
<span class="co">#&gt; [82] memoise_1.1.0          cluster_2.1.0          shinyWidgets_0.5.4    </span>
<span class="co">#&gt; [85] ellipsis_0.3.1         shinyAce_0.4.1</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kevin Rue-Albrecht, Federico Marini, Charlotte Soneson, Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
